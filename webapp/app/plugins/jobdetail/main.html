<div ng-controller="JobDetailPluginCtrl">
    <div class="span12">
        <div class="span7">
            <button class="btn btn-default btn-xs"
                    title="add note"
                    ng-click="addNote()">
                <i class="glyphicon glyphicon-comment"></i>
            </button>
            <div class="btn-group">
                <button class="btn btn-default btn-xs disabled">Log:</button>
                <div class="btn btn-default btn-xs"
                     ng-disabled="!lvArtifact">
                    <a target="_blank" href="{{ lvUrl }}">Structured</a>
                </div>
                <div class="btn btn-default btn-xs"
                     ng-repeat="joblog in logs">
                    <a target="_blank" href="{{ joblog.url }}">Raw</a>
                </div>
            </div>

            <dl class="dl-horizontal">
                <dt class="label label-info">Machine name</dt>
                <dd><a href="https://secure.pub.build.mozilla.org/builddata/reports/slave_health/slave.html?name={{ $scope.job.machine_name }}">{{ job.machine_name }}</a></dd>
                <span ng-repeat="(label, value) in visibleFields">
                    <dt class="label label-info" ng-bind="label"> </dt>
                    <dd ng-bind-html="value" target="_blank"> </dd>
                </span>
            </dl>
        </div>
        <ul class="span7" >
            <li ng-repeat="line in jobArtifact.blob.tinderbox_printlines">
                <div ng-bind-html="line"></div>
            </li>
        </ul>
    </div>
    <div class="span12">
        <dl class="dl-horizontal">
            <dt>
                <i class="glyphicon glyphicon-plus" ng-click="addNote()" title="add note"></i>
                <span class="label label-info">Notes</span>
            </dt>
            <dd>
                <div ng-hide="notes.length==0">
                    <span th-star star-id="notes[0].failure_classification_id"></span> {{ notes[0].note_timestamp*1000|date:'medium' }} <span class="label label-info" ng-bind="notes[0].who"></span> said <em>"<span ng-bind="notes[0].note"></span>"</em>
                </div>
                <span ng-show="notes.length==0">No notes</span>
            </dd>
        </dl>
        <div ng-show="newNote">
            <form ng-submit="saveNote()" class="form-inline">
                <select ng-model="newNote.failure_classification_id"
                        ng-options="key as value.name for (key, value) in starTypes">
                </select>
                <input ng-model="newNote.note" focus-me="focusInput"/>
                <input class="btn btn-primary" type="submit" value="save">
                <a class="btn btn-default" ng-click="clearNewNote()">cancel</a>
            </form>
        </div>
    </div>
</div>
